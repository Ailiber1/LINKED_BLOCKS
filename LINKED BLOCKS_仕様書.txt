LINKED BLOCKS_
Game Specification Document
(Platform-Neutral / AI Build Ready / LATEST)


================================
0. 目的 / 対応環境
================================
本仕様書は以下の環境でそのまま利用可能とする：
・Claude Code
・Google AI Studio（Build / Apps）
・WebベースAI開発環境全般


特定言語・フレームワーク非依存。
状態管理・イベント駆動・UI定義ベースで実装する。


================================
1. ゲーム概要
================================
タイトル：LINKED BLOCKS_
ジャンル：ターン制・連結ブロック対戦


プレイ形式：
・一人でプレイ（CPU）
・マルチプレイ（最大3人）


対応デバイス：
・PC（Web）最優先
・スマートフォン（Web / 9:16対応）


デザインテーマ：
Cyber Terminal / Neon Green / HUD / Matrix Style


================================
2. 起動時格言（毎回表示）
================================
表示文（固定）：
「ブロックを先に揃えて勝利せよ！」


仕様：
・アプリ起動時、毎回必ず表示
・ネオングリーン発光テキスト
・2〜3秒で自動フェードアウト
・クリック／タップで即消去可能
・世界観演出として扱う


同期SE：
・SE_MATCH_READY（対戦決定系インパクト音）


================================
3. UI STATE（共通ステート）
================================
UI_STATE:
- IDLE
- HOVER
- ACTIVE
- DISABLED
- ERROR


視覚ルール：
・HOVER / ACTIVE → 緑発光 + 浮き上がり
・ACTIVE → 常時発光 + 微パルス
・DISABLED → 低コントラスト
・ERROR → 短時間警告色 + 警告SE


================================
4. タイトル画面構成
================================
中央カラム（上から）：
1) ユーザーネーム表示／入力
2) 登録してゲームを始める
3) 登録しないでゲームを始める（ゲスト）
4) 一人でプレイ
5) マルチプレイ


補助ボタン：
・ルール説明を見る
・ランキングを見る（最下部）


================================
5. ユーザーネーム仕様
================================
【登録プレイ】
・ユーザーネーム永続保存
・ランキング対象
・同名重複不可
・再ログイン可


重複時表示：
「このネームは他のユーザーが使用中です」


【ゲスト】
・登録不要
・表示名：PLAYER 1 / PLAYER 2 …
・ランキング対象外


================================
6. ルールブック
================================
・モーダル表示、背景暗転
・スマホ縦スクロール対応


内容：
・勝利条件：4連結（デフォルト）/ 5連結
・縦／横／斜め（＼／）
・初手のみ地面配置
・以降は接地必須
・空中配置、強制落下なし
・タイマー：OFF / 10 / 20 / 30秒
・ランキングは登録ユーザーのみ対象


================================
7. ランキング仕様
================================
表示：
・トップ10表示
・内部保持：最大123位


項目：
・順位 / ユーザーネーム / 勝利数


【一人でプレイ】
・CPUレベル「強」勝利のみ加算


【マルチプレイ】
・優勝者のみ勝利数 +1


================================
8. マルチプレイ（ID認証・ロック）
================================
・ID：任意文字列
・最大3人
・1ID = 1ルーム


IDロック条件：
・待機中 / 対戦中 / 再戦中


解除条件：
・全員が「ゲームを終了する」を選択
・ルーム人数が0になった時点のみ


================================
9. 対戦ルール
================================
・盤面：縦横グリッド
・初手のみ地面配置
・以降は接地必須
・勝利条件：指定数（4/5）連続


================================
10. 画面全体把握方式（確定）
================================
方式：
・ダイナミック・ズームアウト方式（スクロールなし）


挙動：
・ブロックが上方向に積み上がる量に応じて
 表示スケールを段階的に縮小
・常に全ブロックが1画面内に収まるよう調整
・左右比率は固定、縦方向のみで制御


制限：
・最小ズーム率を設定（UI可読性維持）
・これ以上縮小が必要な場合：
 - 引き分け判定
  もしくは
 - タイマー優先ルールに移行


UX方針：
・完全自動
・スクロール／ミニマップ不採用
・全体視認性最優先


================================
11. マルチ対戦：退席（強制離脱）＋継続確認仕様（確定版）
================================
■ 退席（強制離脱）検知
発生条件：
・アプリ完全離脱
・通信切断
・ブラウザ／タブ終了
・クラッシュ


対象：
・同一ルーム内の残り全プレイヤー


■ 退席通知表示
表示内容：
・退席プレイヤー名を赤色で強調表示
・登録ユーザー：登録ネーム
・ゲスト：PLAYER 1 / PLAYER 2 …


文言例：
「〇〇さんが退席しました」


表示仕様：
・ネオンレッド発光ポップ
・画面中央寄り（操作を妨げない）
・約2秒で自動フェードアウト
・警告系SE（短く低め）を再生


■ 継続確認ポップ
表示タイミング：
・退席通知表示後、即時表示


表示文言：
「ゲームを続行しますか？」


選択肢：
・はい
・いいえ


UI仕様：
・ネオンUI
・選択中は緑発光
・決定時にSE再生


■ 継続判定ルール
・残存プレイヤー全員が「はい」
 → ゲーム続行


・1人でも「いいえ」
 → ゲーム即終了
 → ルーム内全員を
   必ずタイトル画面へ遷移


■ ゲーム続行時の挙動
・退席プレイヤーのブロックは削除しない
・盤面は退席時点の状態を維持
・退席プレイヤーのターンは完全スキップ
・残存プレイヤーのみでターン継続


例：
3人 → 1人退席 → 2人対戦として続行


■ 継続中にさらに退席が発生した場合
・残り人数が1人になった時点で自動勝利


表示：
GAME SET!
WINNER : 残ったプレイヤー名


補足表示（小）：
「相手が退席しました」


■ IDロックとの関係
・ルーム存続中は常にIDロック維持
・全員が「ゲームを終了する」を選択し
 人数0になった時点のみID解放


================================
12. 勝利演出
================================
・揃ったブロック座標取得
・中心を貫くネオン発光ライン描画
・縦／横／斜め対応


表示：
GAME SET!
WINNER : ユーザーネーム
（ゲストは PLAYER 1）


================================
13. 効果音（SE）
================================
【UI】
・ホバー：短い電子音
・決定：クリック音
・エラー：警告音


【対戦】
・配置：軽い機械音
・ターン切替：電子通知音
・残り3秒：警告ビープ


【演出】
・起動：SE_MATCH_READY
・勝利：上昇系ネオンSE
・退席通知：低音警告SE


================================
14. BGM仕様
================================
【デフォルト】
・テトリス系ループBGM


【制御】
・BGM ON / OFF
・SE ON / OFF
・即時反映


【差し替え】
・外部音源（mp3 / wav）対応
・Suno AI等で生成したBGM利用可


================================
15. 終了処理
================================
勝利後の選択肢：
・再戦
・ゲームを終了する


終了時：
・タイトル画面へ遷移
・全員退出でID解放


================================
16. 設計思想まとめ
================================
LINKED BLOCKS_ は、
・強制離脱にも破綻しない
・常に盤面全体を把握できる
・音と光で状態が即理解できる
・AI実装に強い


完成度と耐障害性を重視した
連結ブロック対戦ゲームである。